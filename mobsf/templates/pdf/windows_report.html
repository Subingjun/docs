{% block content %}
{% load static %}
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>MobSF 静态分析报告</title>
    <meta name="description" content="MobSF 报告">
    {% if host_os == 'windows' %}
        <link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet' type='text/css'>
        <link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet' type='text/css'>
    {% else %}
    <style>

      /* 拉丁字体 */
      @font-face {
        font-family: 'Open Sans';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Open Sans Regular'), local('OpenSans-Regular'), url('{{base_url}}{% static 'fonts/Open_Sans/OpenSans-Regular.ttf' %}') format('truetype');
      }

      /* 拉丁字体 */
      @font-face {
        font-family: 'Oswald';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: local('Oswald'), local('Oswald'), url('{{base_url}}{% static 'fonts/Oswald/Oswald-Regular.ttf' %}') format('truetype');
      }

  </style>
  {% endif %}
  <link rel="stylesheet" href="{{base_url}}{% static "others/css/pdf_report.css" %}">
  <link rel="stylesheet" href="{{base_url}}{% static "adminlte/plugins/fontawesome-free/css/all.min.css" %}">
  </head>

  <body bgcolor="FFFFFF">
    <article id="cover">
      <div class="header">
        <img src="{{base_url}}{% static "img/mobsf_logo.png" %}" class="center logo" alt="MobSF Logo"/>
        <div class="htext">WINDOWS 静态分析报告 </div>
      </div>
      </br></br></br>
     <div class="app">
      <img class="center" id="icon" src="{{base_url}}{% static 'img/no_icon.png' %}" alt="app_icon"/>
     </div>
      <div class="center">
        <h1><i class="fab fa-apple"></i> {{ app_name }} {% if app_version %} ({{app_version}}) {% endif %}</h1>
      </div>
     </br></br></br></br></br>
      <div class="container">
      <table class="basic no_border">
      <tr class="no_border">
        <td class="no_border"><h3>文件名：</h3></td>
        <td class="no_border"><h3>{{file_name}}</h3></td>
      </tr>
      <tr>
        <td class="no_border"><h3>发布者：</h3></td>
        <td class="no_border"><h3>{{ publisher_name }}</h3></td>
      </tr>

     {% if virus_total and virus_total.items|length > 9 and 'request successfully queued' not in virus_total.verbose_msg %}
        <tr>
        <td class="no_border"><h3>VirusTotal 检测：</h3></td>
        <td class="no_border"><h3><span class="{% if virus_total.positives > 0 %}danger{% else %}success{% endif %}"> {{ virus_total.positives }}/{{ virus_total.total }}</span></h3></td>
      </tr>
      {% endif %}
      <tr>
        <td class="no_border"><h3>扫描日期：</h3></td>
        <td class="no_border"><h3>{{ timestamp }}</h3></td>
      </tr>
    </table>
      </div>
      </br></br>
      </br></br>
      </br></br>
      </br></br>
      </br></br>
      </br></br>
      </br></br>
    </article>

    <article id="contents">


      <h2><i class="fas fa-box-open"></i> 文件信息</h2>

      <h5>文件名：</h5> {{ file_name }}</br>
      <h5>大小：</h5> {{ size }}</br>
      <h5>MD5：</h5> {{ md5 }}</br>
      <h5>SHA1：</h5> {{ sha1 }}</br>
      <h5>SHA256：</h5> {{ sha256 }}</br>


      <h2><i class="fas fa-info"></i> 应用信息</h2>

      <h5>应用名：</h5> {{ app_name }}</br>
      <h5>发布者：</h5> {{ publisher_name }}</br>
      <h5>版本：</h5> {{ app_version }}</br>
      <h5>架构：</h5> {{ architecture }}</br>


      <h2><i class="fas fa-file-code"></i> XML 信息 </h2>

      <h5>编译器版本：</h5> {{ compiler_version }}</br>
      <h5>Visual Studio 版本：</h5> {{ visual_studio_version }}</br>
      <h5>Visual Studio 版本：</h5> {{ visual_studio_edition }}</br>
      <h5>目标操作系统：</h5> {{ target_os }}</br>
      <h5>APPX DLL 版本：</h5> {{ appx_dll_version }}</br>
      <h5>项目 GUID：</h5> {{ proj_guid }}</br>
      <h5>Opti 工具：</h5> {{ opti_tool }}</br>
      <h5>目标运行：</h5> {{ target_run }}</br>


        {% if virus_total and virus_total.items|length > 9 and 'request successfully queued' not in virus_total.verbose_msg %}
       <h2><i class="fas fa-spider"></i> VIRUSTOTAL 扫描</h2>
       <p> <h5>{{ virus_total.positives }} / {{ virus_total.total }}</h5> &nbsp; 杀毒软件发现此文件有恶意！ </p>
            {% if virus_total.positives %}

                    <table class="basic">
                                    <thead>
                                        <tr>
                                            <th>杀毒软件</th>
                                            <th>检测情况</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    {% for av_name,av_result in virus_total.scans.items %}
                                        {% if av_result.detected == True %}
                                            <tr>
                                                <td>
                                                    {{ av_name }}
                                                </td>
                                                <td>
                                                    <span class="danger">{{ av_result.result }}</span>
                                                </td>
                                          </tr>
                                        {% endif %}
                                    {% endfor %}
                               </tbody>
                    </table>
            {% endif %}
      {% endif %}

      <h2><i class="fas fa-flag"></i> APPX 二进制分析</h2>
       <table class="basic">
                  <thead>
                      <tr>
                          <th>问题</th>
                          <th>状态</th>
                          <th>描述</th>
                          <th>信息</th>

                      </tr>
                  </thead>
                  <tbody>
                    {% for result in binary_analysis %}
                      <tr>
                        <td>{{ result.rule_id }}</td>
                        <td>
                          {% if result.status == "Insecure" %}
                            <span class='danger'>
                          {% endif %}
                          {% if result.status == "Secure" %}
                            <span class='success'>
                          {% endif %}
                          {% if result.status == "Info" %}
                            <span class='info'>
                          {% endif %}
                              {{ result.status }}
                          </span>
                        </td>
                        <td>{{ result.desc }}</td>
                        <td>{{ result.info }}</td>
                      </tr>
                    {% endfor %}
                    {% for warn in binary_warnings %}
                    <tr>
                      <td>{{ warn.rule_id }}</td>
                      <td>
                          <span class='info'>
                            {{ warn.status }}
                        </span>
                      </td>
                      <td>{{ warn.desc }}</td>
                      <td>{{ warn.info }}
                    </tr>
                    {% endfor %}
                    </tbody>
                    </table>

    </article>

    <article id="columns">
      </br>
      <hr>
      <h3>报告生成者 - MobSF {{ version }} </h3>
      <section>
        <p>
          移动安全框架（MobSF）是一个自动化的、集成的移动应用（Android/iOS/Windows）渗透测试、恶意软件分析和安全评估框架，能够执行静态和动态分析。
        </p>
        <p>
        <strong>© {% now "Y" %} 移动安全框架 - MobSF | <a href="https://ajinabraham.com">Ajin Abraham</a> | <a href="https://opensecurity.in">OpenSecurity</a>.</strong>
      </p>
      </section>
    </article>
  </body>
</html>
{% endblock %}
